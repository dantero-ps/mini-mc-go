---
phase: 12
name: World Gen Config & UI
wave: 2
depends_on: [12-01]
files_modified:
  - internal/config/world_gen.go
  - internal/config/config.go
  - internal/ui/menu/world_gen_menu.go
  - internal/ui/menu/main_menu.go
  - internal/game/game.go
  - internal/world/world.go
autonomous: false
must_haves:
  truths:
    - "Users can toggle authentic generation on/off"
    - "Configuration persists or defaults correctly"
  artifacts:
    - path: "internal/config/world_gen.go"
      provides: "Config struct"
    - path: "internal/ui/menu/world_gen_menu.go"
      provides: "UI Menu"
  key_links: []
---

# Plan: World Gen Config & UI

This plan exposes the new 1.8.9 generation logic to the user via a new configuration menu. It allows runtime switching (or restart-based switching) between the existing generator and the new authentic generator.

## Understanding
We need a way to toggle the new generator. Hardcoding it is bad for testing comparison. We will add a "World Gen Settings" menu accessible from the Main Menu.

## Tasks

<tasks>
<task type="auto">
  <name>Config Implementation</name>
  <files>internal/config/world_gen.go, internal/config/config.go</files>
  <action>Create `internal/config/world_gen.go`. Define `WorldGenSettings` struct with `UseAuthenticGen`, `SeaLevel`, `Caves`. Add `WorldGen` field to the global `Config` struct in `internal/config/config.go`. Ensure default values are set correctly.</action>
  <verify>Run `go build ./internal/config/...` to check for struct definition errors.</verify>
  <done>Config updated.</done>
</task>

<task type="auto">
  <name>UI Implementation</name>
  <files>internal/ui/menu/world_gen_menu.go</files>
  <action>Create `internal/ui/menu/world_gen_menu.go`. Implement `WorldGenMenu` struct implementing the `Menu` interface. Add widgets: Button/Toggle for Generator type, Slider for Sea Level, Back button.</action>
  <verify>Check that `WorldGenMenu` implements `Menu` interface.</verify>
  <done>UI Menu created.</done>
</task>

<task type="auto">
  <name>Main Menu Integration</name>
  <files>internal/ui/menu/main_menu.go</files>
  <action>Modify `internal/ui/menu/main_menu.go`. Add a new button "World Gen Settings" that pushes `WorldGenMenu` onto the stack.</action>
  <verify>Verify `main_menu.go` compiles with the new button reference.</verify>
  <done>Main menu integrated.</done>
</task>

<task type="auto">
  <name>Generator Wiring</name>
  <files>internal/game/game.go, internal/world/world.go</files>
  <action>Locate where the `World` or `ChunkProvider` is initialized (likely `internal/game/game.go` or `internal/world/world.go`). Modify the initialization logic to check `config.WorldGen.UseAuthenticGen`. If true, instantiate `ChunkProvider189`. If false, use the existing `DensityGenerator`.</action>
  <verify>Run `go build ./internal/game/...` to ensure it compiles without panic.</verify>
  <done>Generator wired to config.</done>
</task>

<task type="checkpoint:human-verify">
  <name>Verification</name>
  <files></files>
  <action>Start the game. Navigate to World Gen Settings and enable Authentic Gen. Start a new world and verify terrain looks different.</action>
  <verify>Manual verification of the UI and generation switch.</verify>
  <done>Feature verified.</done>
</task>
</tasks>

<verification>
"World Gen Settings" menu exists and works.
Config is persisted (or at least held in memory for the session).
Selecting "Authentic Gen" switches the backend generator.
</verification>

<success_criteria>
User can configure and use 1.8.9 world generation.
</success_criteria>

<output>
After completion, create `.planning/phases/12-implement-1-8-9-world-gen-logic-config-menus/12-02-SUMMARY.md`
</output>
